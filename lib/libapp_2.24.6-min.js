window.dataLayer=window.dataLayer||[];if(!window.SITE){window.SITE={gtagInitiated:false,root:"/mapa"}}SITE.checkCookieConsent=function(){var a=document.cookie.match(/(;)?diatonic-policy=([^;]*);?/);const c=a?Boolean(a[2]||false):false;var b=jQuery(".policy-section");setTimeout(function(){if(!c){b.show()}},3000);jQuery(".policy-section-actions").click(function(){document.cookie="diatonic-policy=true; path=/; expires=Fri, 31 Dec 9999 23:59:59 GMT;";b.fadeOut()})};SITE.clearCookieConsent=function(){document.cookie="diatonic-policy=; path=/; expires=Fri, 31 Dec 9999 23:59:59 GMT;"};SITE.sizeOfThings=function(){SITE.winSize={w:window.innerWidth,h:window.innerHeight};SITE.size={w:screen.width,h:screen.height};return SITE.size};SITE.ga=function(){if(arguments[0]==="set"&&arguments[1]==="page_path"){SITE.root=arguments[2]}if(gtag&&(window.location.href.indexOf("diatonicmap")>=0||window.location.href.indexOf("androidplatform")>=0)&&SITE.getVersion("mainSITE","")!=="debug"&&SITE.getVersion("mainSITE","")!=="unknown"){if(SITE.debug){console.log("App is in Debug mode")}else{if(!SITE.gtagInitiated){gtag("js",new Date());gtag("config","G-3RXNND5N5Y",{page_title:SITE.root.includes("app")?"Diatonic App":"Diatonic Map",page_path:SITE.root,site_version:SITE.siteVersion,abcx_version:SITE.abcxVersion,event_category:"View"});SITE.gtagInitiated=true}gtag(arguments[0],arguments[1],arguments[2])}}else{console.log("Funcao gtag não definida.")}};SITE.startLoader=function(e,b,d,c){var a=new window.widgets.Loader({id:e,bars:0,radius:0,lineWidth:20,lineHeight:70,timeout:1,background:"rgba(0,0,0,0.5)",container:b?b:document.body,onstart:d,oncomplete:c});return a};SITE.askHelp=function(){if(!SITE.properties.options.doNotAskHelp&&SITE.App){var e=document.getElementById("askHelpDiv");if(e){setTimeout(function b(){$("#askHelpDiv").slideDown()},2000);var a=document.getElementById("askHelpBtn");var g=document.getElementById("askHelpChk");a.addEventListener("click",function(c){e.style.display="none";SITE.properties.options.doNotAskHelp=g.checked;if(SITE.properties.options.doNotAskHelp){SITE.SaveProperties()}SITE.ga("event","askedHelp",{event_category:"Configuration",event_label:SITE.properties.options.doNotAskHelp?"Refused":"JustClosed"})},false)}}};SITE.findGetParameter=function(c){var a=null,e=[];var b=window.location.search.substring(1).split("&");for(var d=0;d<b.length;d++){e=b[d].split("=");if(e[0]===c){a=decodeURIComponent(e[1])}}return a};SITE.getDate=function(){var b=new Date();var a=b.getDate();var c=b.getMonth()+1;var d=b.getFullYear();return d*10000+c*100+a};SITE.getVersion=function(a,b){var d=document.getElementById(a);if(!d){return"unknown"}var c=d.src.match(/\_[0-9]*\.[0-9]*[\.[0-9]*]*/g);return c?b+c[0].substring(1):"debug"};SITE.getLanguage=function(){var b=window.navigator.userLanguage||window.navigator.language;if(b.indexOf("-")>=0){b=b.replace("-","_");for(var a in SITE.properties.known_languages){if(a.toLowerCase()===b.toLocaleLowerCase()){return a}}}for(var a in SITE.properties.known_languages){if(a.substring(0,2)===b.substring(0,2)){return a}}return"en_US"};SITE.LoadProperties=function(){var b=false;try{SITE.properties=JSON.parse(FILEMANAGER.loadLocal("diatonic-map.site.properties"))}catch(c){waterbug.log("Could not load the properties.");waterbug.show();SITE.ga("event","exception",{event_category:"Error",description:"html5storage: Could not load the properties.",fatal:false})}var a=SITE.getVersion("mainSITE","");if(!SITE.properties){SITE.ResetProperties()}else{if(a==="debug"){SITE.properties.options.showConsole=true}else{if(!SITE.properties.version||SITE.properties.version==="debug"||parseFloat(SITE.properties.version)<parseFloat(a)){SITE.properties.version=a;b=true}}}if(!SITE.properties.known_languages||!SITE.properties.known_languages.ru_RU){SITE.properties.known_languages={de_DE:{file:"languages/de_DE.lang",image:"images/de_DE.png",name:"Deustch"},en_US:{file:"languages/en_US.lang",image:"images/en_US.png",name:"US English"},es_ES:{file:"languages/es_ES.lang",image:"images/es_ES.png",name:"Español"},fr_FR:{file:"languages/fr_FR.lang",image:"images/fr_FR.png",name:"Français"},it_IT:{file:"languages/it_IT.lang",image:"images/it_IT.png",name:"Italiano"},ru_RU:{file:"languages/ru_RU.lang",image:"images/ru_RU.png",name:"Русский язык"},pt_BR:{file:"languages/pt_BR.lang",image:"images/pt_BR.png",name:"Português do Brasil"}};SITE.properties.options.language=SITE.getLanguage();window.myLanguage=SITE.properties.options.language;SITE.properties.colors.highLight="#ff0000";SITE.properties.options.showWarnings=false;SITE.properties.options.showConsole=false;SITE.properties.options.pianoSound=false;SITE.properties.options.autoRefresh=false;SITE.properties.options.keyboardRight=false;SITE.properties.options.suppressTitles=false;b=true}if(!SITE.properties.studio.media){SITE.properties.studio.media={visible:false,top:"20px",left:"1200px",width:100,height:200};SITE.properties.partGen.media={visible:false,top:"20px",left:"1200px",width:100,height:200};b=true}if(!SITE.properties.partEdit){SITE.properties.partEdit={media:{visible:false,top:"20px",left:"1200px",width:100,height:200},editor:{visible:true,floating:false,maximized:false,top:"40px",left:"50px",width:"700px",height:"480px"},keyboard:{visible:false,top:"65px",left:"1200px",scale:1,mirror:true,transpose:false,label:false}};b=true}SITE.properties.options.lyrics=true;SITE.properties.options.fingering=true;if(SITE.properties.options.tabFormat===undefined){b=true;SITE.properties.options.tabFormat=0}if(SITE.properties.options.guidedTour===undefined){b=true;SITE.properties.options.guidedTour=false}if(b){SITE.SaveProperties()}};SITE.SaveProperties=function(){try{FILEMANAGER.saveLocal("diatonic-map.site.properties",JSON.stringify(SITE.properties))}catch(a){waterbug.log("Could not save the properties");waterbug.show();SITE.ga("event","exception",{event_category:"Error",description:"html5storage: Could not save the properties",fatal:false})}};SITE.ResetProperties=function(){SITE.properties={};SITE.properties.known_languages={de_DE:{file:"languages/de_DE.lang",image:"images/de_DE.png",name:"Deustch"},en_US:{file:"languages/en_US.lang",image:"images/en_US.png",name:"US English"},es_ES:{file:"languages/es_ES.lang",image:"images/es_ES.png",name:"Español"},fr_FR:{file:"languages/fr_FR.lang",image:"images/fr_FR.png",name:"Français"},it_IT:{file:"languages/it_IT.lang",image:"images/it_IT.png",name:"Italiano"},ru_RU:{file:"languages/ru_RU.lang",image:"images/ru_RU.png",name:"Русский язык"},pt_BR:{file:"languages/pt_BR.lang",image:"images/pt_BR.png",name:"Português do Brasil"}};SITE.properties.version=SITE.getVersion("mainSITE","");SITE.properties.colors={useTransparency:true,highLight:"#ff0000",fill:"white",background:"none",close:"#ff3a3a",open:"#ffba3b"};SITE.properties.options={language:SITE.getLanguage(),showWarnings:false,showConsole:false,pianoSound:false,autoRefresh:false,keyboardRight:false,suppressTitles:false,tabFormat:0};SITE.properties.mediaDiv={visible:true,top:"20px",left:"1200px",width:100,height:200};
SITE.properties.tabGen={abcEditor:{floating:false,maximized:false,top:"70px",left:"25px",width:"940px",height:"560px"},tabEditor:{floating:false,maximized:false,top:"140px",left:"75px",width:"940px",height:"560px"}};SITE.properties.partEdit={media:{visible:false,top:"20px",left:"1200px",width:100,height:200},editor:{visible:true,floating:false,maximized:false,top:"40px",left:"50px",width:"700px",height:"480px"},keyboard:{visible:false,top:"65px",left:"1200px",scale:1,mirror:true,transpose:false,label:false}};SITE.properties.partGen={showABCText:false,convertFromClub:false,convertToClub:false,media:{visible:false,top:"20px",left:"1200px",width:100,height:200},editor:{visible:true,floating:false,maximized:false,top:"40px",left:"50px",width:"700px",height:"480px"},keyboard:{visible:false,top:"65px",left:"1200px",scale:1,mirror:true,transpose:false,label:false}};SITE.properties.studio={mode:"normal",timerOn:false,trebleOn:true,bassOn:true,media:{visible:false,top:"20px",left:"1200px",width:100,height:200},editor:{visible:true,floating:false,maximized:false,top:"40px",left:"50px",width:"700px",height:"480px"},keyboard:{visible:false,top:"65px",left:"1200px",scale:1,mirror:true,transpose:false,label:false}};FILEMANAGER.saveLocal("ultimaTablaturaEditada","");FILEMANAGER.saveLocal("ultimaPartituraEditada","");SITE.SaveProperties()};if(!window.SITE){window.SITE={gtagInitiated:false,root:"/mapa"}}if(!window.SITE.lang){window.SITE.lang={}}SITE.Translator=function(a){a=a||{};if(!a.language){a.language="pt_BR"}this.language=null;this.loadLanguage(a.language,a.callback)};SITE.Translator.prototype.loadLanguage=function(d,e){var c=1;var b=this;FILEMANAGER.register("LANG");if(!SITE.properties||!SITE.properties.known_languages){SITE.ResetProperties()}if(!SITE.properties.known_languages[d]){b.log("Unknown language: "+d+". Loading English...");d="en_US";SITE.properties.options.language=d;SITE.SaveProperties()}var a=SITE.properties.known_languages[d].file;$.getJSON(a,{format:"json"}).done(function(f){FILEMANAGER.deregister("LANG",true);b.language=f}).fail(function(g,h,f){FILEMANAGER.deregister("LANG",false);b.log("Failed to load language "+d+":\nLoading: "+g.responseText.substr(1,40)+"...\nError:\n "+h+", "+f+".")}).always(function(){c--;if(c===0){e&&e()}})};SITE.Translator.prototype.menuPopulate=function(e,d){var a,b;e.emptySubMenu(d);for(var f in SITE.properties.known_languages){var c='<img src="'+SITE.properties.known_languages[f].image+'" />&#160;'+SITE.properties.known_languages[f].name;a=e.addItemSubMenu(d,c+"|"+f);if(this.language&&this.language.id===f){b=a}}if(b){e.setSubMenuTitle(d,e.selectItem(d,b))}};SITE.Translator.prototype.getResource=function(b){if(!this.language){return null}var a=this.language.resources[b];if(!a){this.log('Missing translation for "'+b+'" in "'+this.language.langName+'".');a=b}return a};SITE.Translator.prototype.translate=function(b){if(!this.language){return}b=b||document;var e=b.querySelectorAll("[data-translate]");var g=Array.prototype.slice.apply(e);for(var d=0;d<g.length;d++){var f=g[d];var a=f.getAttribute("data-translate");var c=this.language.resources[a];if(!c){if(a.startsWith("GAITA_")||a.startsWith("CORONA_")||a.startsWith("HOHNER_")||a.startsWith("CONCERTINA_")){continue}this.log('Missing translatation for "'+a+'" in "'+this.language.langName+'".');continue}switch(f.nodeName){case"INPUT":if(f.type==="text"){f.title=c.tip;f.value=c.val}break;case"BUTTON":case"DIV":case"I":f.title=c;break;case"A":f.href=c;break;default:f.innerHTML=c}}};SITE.Translator.prototype.sortLanguages=function(){this.languages.sort(function(d,c){return parseInt(d.menuOrder)-parseInt(c.menuOrder)})};SITE.Translator.prototype.log=function(a){console.log(a)};if(!window.SITE){window.SITE={gtagInitiated:false,root:"/mapa"}}SITE.Media=function(c,e,b,a){var d=this;this.Div=c||null;this.proportion=0.55666667;this.youTubeURL=false;this.properties=b;this.isApp=a;if(e){this.showMediaButton=document.getElementById(e);this.showMediaButton.addEventListener("click",function(){d.callback("OPEN")},false)}this.mediaWindow=new DRAGGABLE.ui.Window(this.Div,null,{title:"showMedia",translator:SITE.translator,alternativeResize:true,top:this.properties.top,left:this.properties.left},{listener:this,method:"callback"})};SITE.Media.prototype.callback=function(b){switch(b){case"RESIZE":this.resize();var a=this.mediaWindow.dataDiv;this.properties.width=a.clientWidth;this.properties.height=a.clientHeight;SITE.SaveProperties();break;case"MOVE":var a=this.mediaWindow.topDiv;this.properties.top=a.style.top;this.properties.left=a.style.left;SITE.SaveProperties();break;case"OPEN":this.properties.visible=true;SITE.ga("event","page_view",{page_title:this.tabTitle,page_path:SITE.root+"/media",event_category:"View"});SITE.SaveProperties();this.mediaWindow.setVisible(true);this.resize();this.posiciona();if(this.showMediaButton){this.showMediaButton.style.display="none"}break;case"CLOSE":this.pause();this.properties.visible=false;SITE.SaveProperties();if(this.showMediaButton){this.mediaWindow.setVisible(false);this.showMediaButton.style.display="block"}break}return false};SITE.Media.prototype.pause=function(){if(!this.mediaWindow||!this.currTab){return}var a=this.currTab.div.getElementsByTagName("iframe")[0];if(!a){return}a.contentWindow.postMessage('{"event":"command","func":"pauseVideo", "args":""}',"*")};SITE.Media.prototype.show=function(f){var h=this;var c,i;if(f.abc&&f.abc.metaText.url){c=f.abc.metaText.url}if(c){var d=300;var g=17;if(c!==this.url){this.url=c;this.tabTitle=f.abc.metaText.title;if(this.properties.width>100){d=this.properties.width;g=Math.round((d-100)/11)}else{if(window.innerWidth>=1200){d=600;g=46}else{if(window.innerWidth>=950){d=400;g=27}}}var o=d*this.proportion;this.mediaWindow.dataDiv.style.width=d+"px";this.mediaWindow.topDiv.style.width=d+"px";this.mediaWindow.dataDiv.style.height=o+"px";this.mediaWindow.topDiv.style.height=o+"px";if(!this.tabDiv){this.tabDiv=document.createElement("div");this.tabDiv.className="media-tabs"+(this.isApp?" media-tabs-big":"");this.mediaWindow.topDiv.appendChild(this.tabDiv)}else{this.tabDiv.innerHTML="";this.mediaWindow.dataDiv.innerHTML=""}var m=c.split("\n");this.tabs={};this.currTab=null;for(var a=0;a<m.length&&a<10;a++){var p=(this.mediaWindow.id*10+a);this.youTubeURL=(m[a].match(/www.youtube-nocookie.com/g)!==null);this.isPDF=(m[a].match(/.*pdf/)!==null);var l=m[a].match(/\&.*\;/g);var n=m[a];var k="";if(l){n=m[a].replace(l[0],"");k=l[0].substring(3,l[0].length-1);if(k.length>g){k=k.substring(0,g)+"..."}}var b=document.createElement("div");b.className="media-content";this.mediaWindow.dataDiv.appendChild(b);if(this.youTubeURL){i='<iframe id="e'+p+'" src="'+n+'?rel=0&amp;showinfo=0&amp;enablejsapi=1" frameborder="0" allowfullscreen="allowfullscreen" ></iframe>'}else{i='<embed id="e'+p+'" src="'+n+'" "></embed>'}b.innerHTML=i;this.embed=document.getElementById("e"+p);this.embed.style.width="100%";this.embed.style.height=(this.youTubeURL?"100%":(this.isPDF?"calc(100% - 4px)":"auto"));
this.tabs["w"+p]={div:b,tit:k,u2be:this.youTubeURL};if(m.length>1){var e=document.createElement("input");e.id="w"+p;e.type="radio";e.name="mediaControl"+this.mediaWindow.id;e.className="tab-selector-"+a;this.tabDiv.appendChild(e);var e=document.createElement("label");e.htmlFor="w"+p;e.className="media-tab-label-"+a;e.innerHTML="#"+(a+1);this.tabDiv.appendChild(e)}}this.showTab=function(s){this.pause();for(var q in this.tabs){this.tabs[q].div.className="media-content";if(!s){s=q;var r=document.getElementById(s);if(r){r.checked=true}}}this.tabs[s].div.className="media-visible";this.currTab=this.tabs[s];this.mediaWindow.dataDiv.style.overflow=this.currTab.u2be?"hidden":"auto";this.mediaWindow.setSubTitle(this.currTab.tit?"- "+this.currTab.tit:"");this.resize()};if(m.length>1){var j=document.getElementsByName("mediaControl"+this.mediaWindow.id);for(var a=0;a<j.length;a++){j[a].addEventListener("change",function(){h.showTab(this.id)})}}h.showTab()}if(this.showMediaButton){this.showMediaButton.style.display=(this.properties.visible?"none":"inline")}this.mediaWindow.setVisible(this.properties.visible);if(this.properties.visible){this.resize();this.posiciona()}else{this.pause()}}else{this.pause();this.mediaWindow.setVisible(false);if(this.showMediaButton){this.showMediaButton.style.display="none"}}};SITE.Media.prototype.posiciona=function(){if(!this.mediaWindow.topDiv||this.mediaWindow.topDiv.style.display==="none"){return}var b=document.body.clientWidth||document.documentElement.clientWidth||window.innerWidth;b=Math.min(b,this.mediaWindow.parent.clientWidth);var d=this.mediaWindow.topDiv;var a=parseInt(d.style.left.replace("px",""));var c=a;if(a+d.offsetWidth>b){a=(b-(d.offsetWidth+30))}if(a<0){a=10}if(a!==c){d.style.left=a+"px";this.properties.left=a+"px";SITE.SaveProperties()}};SITE.Media.prototype.resize=function(){var b=this.mediaWindow.menuDiv.clientHeight+(this.mediaWindow.bottomBar?this.mediaWindow.bottomBar.clientHeight:0);this.mediaWindow.dataDiv.style.width=this.mediaWindow.topDiv.clientWidth+"px";this.mediaWindow.dataDiv.style.height=(this.mediaWindow.topDiv.clientHeight-b)+"px";if(this.currTab.u2be){var a=(this.mediaWindow.topDiv.clientWidth*this.proportion);this.mediaWindow.dataDiv.style.height=a+"px";this.mediaWindow.topDiv.style.height=(a+b)+"px"}};if(!window.SITE){window.SITE={gtagInitiated:false,root:"/mapa"}}SITE.Modal=function(a){this.modalWindow=undefined;this.iframe=undefined;this.container=undefined;this.options=a||{};this.options.width=typeof this.options.width==="undefined"?"800":this.options.width;this.options.height=typeof this.options.height==="undefined"?undefined:this.options.height;this.options.print=typeof this.options.print==="undefined"?true:this.options.print;this.options.callback=typeof this.options.callback==="undefined"?{listener:this,method:"modalDefaultCallback"}:this.options.callback;this.options.type=typeof this.options.type==="undefined"?"modal":this.options.type;this.options.disableLinks=typeof this.options.disableLinks==="undefined"?false:this.options.disableLinks};SITE.Modal.prototype.getContainer=function(){return this.container};SITE.Modal.prototype.close=function(){this.iframe.setAttribute("data","");this.modalWindow.setVisible(false)};SITE.Modal.prototype.modalDefaultCallback=function(b,a){if(b==="CLOSE"){this.close()}};SITE.Modal.prototype.checkClustrmaps=function(){var b=this;var a=b.iframe.contentDocument.getElementById("clustrmaps-widget");if(a){b.iframe.addEventListener("load",function(){if(b.options.disableLinks){b.disableLinks(b.iframe.contentDocument)}})}else{if(b.options.disableLinks){b.disableLinks(b.iframe.contentDocument)}}};SITE.Modal.prototype.disableLinks=function(c){return false;var b=c.getElementsByTagName("a");for(var a=0;a<b.length;a++){b[a].style.pointerEvents="none"}};SITE.Modal.prototype.show=function(j,e,b,a){var f=this;var h,l,d,c;a=a||{};this.options.width=typeof a.width==="undefined"?this.options.width:a.width;this.options.height=typeof a.height==="undefined"?this.options.height:a.height;this.options.print=typeof a.print==="undefined"?this.options.print:a.print;if(this.options.type==="help"){var g=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var i=g/2-this.options.width/2;h="150px";d=i+"px";l="auto";c="auto"}else{h="30px";l="90%";d="60px";c="calc(92% - 60px)"}if(!this.modalWindow){this.modalWindow=new DRAGGABLE.ui.Window(null,["print|printBtn"],{title:"",translator:SITE.translator,draggable:true,statusbar:false,top:h,height:l,left:d,width:c,zIndex:80},this.options.callback);this.modalWindow.dataDiv.style.height="auto"}this.modalWindow.setTitle(j,SITE.translator);this.modalWindow.setSubTitle(e,SITE.translator);this.modalWindow.setButtonVisible("PRINT",this.options.print);if(this.options.type==="help"){this.modalWindow.dataDiv.innerHTML='<object id="myFrame" data="'+b+'" type="text/html" ></object>'}else{this.modalWindow.dataDiv.innerHTML='<object id="myFrame" data="'+b+'" type="text/html" ></object>          <div id="pg" class="pushbutton-group" style="right: 4px; bottom: 4px;" >         <div id="btClose"></div>\n         </div>';this.modalWindow.addPushButtons(["btClose|close"])}SITE.ga("event","page_view",{page_title:SITE.translator.getResource(e||j),page_path:SITE.root+"/help",event_category:"View"});var k=SITE.startLoader("Modal",this.modalWindow.dataDiv);this.iframe=this.modalWindow.dataDiv.getElementsByTagName("object")[0];this.modalWindow.setVisible(true);if(this.options.type==="help"){f.iframe.style.width=f.options.width+"px";f.iframe.style.height=(f.options.height?f.options.height:400)+"px";f.modalWindow.dataDiv.style.overflow="hidden";f.modalWindow.dataDiv.style.opacity="1";k.start(function(){if(j==="AboutTitle"){var n=window.setInterval(function m(){var o=f.iframe.contentDocument.getElementById("siteVerI");f.checkClustrmaps();if(o){clearInterval(n);o.innerHTML=SITE.siteVersion;f.iframe.contentDocument.body.style.overflow="hidden";f.iframe.style.height=f.iframe.contentDocument.body.clientHeight+"px";f.modalWindow.dataDiv.style.opacity="1";k.stop()}},300)}else{var n=window.setInterval(function m(){var q=f.iframe.contentDocument.getElementById("helpHeader");f.checkClustrmaps();if(q){clearInterval(n);f.modalWindow.dataDiv.style.opacity="0";f.container=f.iframe.contentDocument.getElementById("helpContainer");var q=f.iframe.contentDocument.getElementById("helpHeader");var p=f.iframe.contentDocument.getElementById("helpFrame");if(q){q.style.display="none"}if(p){p.style.overflow="hidden"}f.iframe.style.height=f.options.height+"px";if(f.container){f.container.style.top="0";f.container.style.height=(f.options.height-18)+"px";f.container.style.overflow="hidden";f.container.style.border="1px solid rgba(255, 153, 34, 0.2)";var o=new PerfectScrollbar(f.container,{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],wheelSpeed:1,wheelPropagation:false,suppressScrollX:false,minScrollbarLength:100,swipeEasing:true,scrollingThreshold:500})}f.modalWindow.dataDiv.style.opacity="1";
k.stop()}},100)}},"<br/>&#160;&#160;&#160;"+SITE.translator.getResource("wait")+"<br/><br/>")}else{f.iframe.style.width="100%";f.iframe.style.height=(f.modalWindow.topDiv.clientHeight-25)+"px";f.modalWindow.dataDiv.style.overflow="hidden";f.modalWindow.topDiv.style.opacity="0";k.start(function(){var n=window.setInterval(function m(){var p=true;if(j==="AboutAppTitle"){var p=f.iframe.contentDocument.getElementById("siteVerI")}f.container=f.iframe.contentDocument.getElementById("modalContainer");f.checkClustrmaps();if(f.container&&p){clearInterval(n);if(typeof p==="object"){p.innerHTML=SITE.siteVersion}f.container.style.top="0";f.container.style.height=(f.modalWindow.dataDiv.clientHeight-70)+"px";f.container.style.overflow="hidden";f.container.style.border="1px solid rgba(255, 153, 34, 0.2)";var o=new PerfectScrollbar(f.container,{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],wheelSpeed:1,wheelPropagation:false,suppressScrollX:false,minScrollbarLength:100,swipeEasing:true,scrollingThreshold:500});f.modalWindow.topDiv.style.opacity="1";k.stop()}},300)},"<br/>&#160;&#160;&#160;"+SITE.translator.getResource("wait")+"<br/><br/>")}};if(!window.SITE){window.SITE={gtagInitiated:false,root:"/mapa"}}SITE.AppView=function(d,e,c){var b=this;this.app=d;this.parserparams={};this.kbDivs={};this.ypos=0;this.lastStaffGroup=-1;this.lastYpos=0;this.warnings=[];this.renderedTune={text:undefined,abc:undefined,title:undefined,tab:undefined,div:undefined,selector:undefined};this.Div=new DRAGGABLE.ui.Window(e.studioDiv,null,{translator:SITE.translator,statusbar:false,draggable:false,top:"0",left:"0",width:"100%",height:"100%",title:"EstudioTitle"},{listener:this,method:"appViewCallBack"});this.controlDiv=document.createElement("DIV");this.controlDiv.setAttribute("id","controlDiv");this.controlDiv.setAttribute("class","controlDiv btn-group draggableToolBarApp");this.Div.dataDiv.appendChild(this.controlDiv);this.studioCanvasDiv=document.createElement("DIV");this.studioCanvasDiv.setAttribute("id",e.studioCanvasDiv);this.studioCanvasDiv.setAttribute("class","studioCanvasDiv");this.canvasDiv=document.createElement("DIV");this.canvasDiv.setAttribute("id","canvasDiv");this.canvasDiv.setAttribute("class","canvasDiv");this.outerCanvasDiv=document.createElement("DIV");this.outerCanvasDiv.setAttribute("id","outerCanvasDiv");this.outerCanvasDiv.setAttribute("class","outerCanvasDiv");this.outerCanvasDiv.appendChild(this.canvasDiv);this.keyboardDiv=document.createElement("DIV");this.keyboardDiv.setAttribute("id","keyboardDiv");this.keyboardDiv.setAttribute("class","keyboardDiv");this.outerKeyboardDiv=document.createElement("DIV");this.outerKeyboardDiv.setAttribute("id","outerKeyboardDiv");this.outerKeyboardDiv.setAttribute("class","outerKeyboardDiv");this.outerKeyboardDiv.appendChild(this.keyboardDiv);this.studioCanvasDiv.appendChild(this.outerKeyboardDiv);this.studioCanvasDiv.appendChild(this.outerCanvasDiv);this.Div.dataDiv.appendChild(this.studioCanvasDiv);this.Div.setVisible(true);this.Div.dataDiv.style.overflow="hidden";if(e.generate_tablature){if(e.generate_tablature==="accordion"){this.accordion=new window.ABCXJS.tablature.Accordion(e.accordion_options,SITE.properties.options.tabFormat);if(e.accordionNameSpan){this.accordionNameSpan=document.getElementById(e.accordionNameSpan);this.accordionNameSpan.innerHTML=this.accordion.getFullName()}}else{throw new Error("Tablatura para "+e.generate_tablature+" não suportada!")}}var a=0;if(SITE.size.h>=500){a=1}else{if(SITE.size.h>=432){a=0.915}else{if(SITE.size.h>=412){a=0.87}else{if(SITE.size.h>=393){a=0.82}else{if(SITE.size.h>=360){a=0.74}else{a=0.7}}}}}this.accordion.setRenderOptions({draggable:false,show:SITE.properties.studio.keyboard.visible,transpose:SITE.properties.studio.keyboard.transpose,mirror:SITE.properties.studio.keyboard.mirror,scale:a,label:SITE.properties.studio.keyboard.label});this.controlDiv.innerHTML=document.getElementById(e.studioControlDiv).innerHTML;document.getElementById(e.studioControlDiv).innerHTML="";this.media=new SITE.Media(this.Div.dataDiv,e.btShowMedia,SITE.properties.studio.media,true);this.renderedTune.div=this.canvasDiv;if(this.ps){this.ps.destroy()}if(this.ps2){this.ps2.destroy()}this.ps2=new PerfectScrollbar(this.outerKeyboardDiv,{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],wheelSpeed:1,wheelPropagation:false,suppressScrollX:true,minScrollbarLength:100,swipeEasing:true,scrollingThreshold:500});this.ps=new PerfectScrollbar(this.canvasDiv,{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],wheelSpeed:1,wheelPropagation:false,suppressScrollX:false,minScrollbarLength:100,swipeEasing:true,scrollingThreshold:500});if(e.onchange){this.onchangeCallback=e.onchange}this.printButton=document.getElementById(e.printBtn);this.backButton=document.getElementById(e.backBtn);this.showMapButton=document.getElementById(e.showMapBtn);this.modeButton=document.getElementById(c.modeBtn);this.lyricsButton=document.getElementById(c.lyricsBtn);this.fingeringButton=document.getElementById(c.fingeringBtn);this.tabformatButton=document.getElementById(c.tabformatBtn);this.timerButton=document.getElementById(c.timerBtn);this.FClefButton=document.getElementById(c.FClefBtn);this.GClefButton=document.getElementById(c.GClefBtn);this.playButton=document.getElementById(c.playBtn);this.stopButton=document.getElementById(c.stopBtn);this.gotoMeasureButton=document.getElementById(c.gotoMeasureBtn);this.untilMeasureButton=document.getElementById(c.untilMeasureBtn);this.currentPlayTimeLabel=document.getElementById(c.currentPlayTimeLabel);this.stepButton=document.getElementById(c.stepBtn);this.stepMeasureButton=document.getElementById(c.stepMeasureBtn);this.repeatButton=document.getElementById(c.repeatBtn);this.clearButton=document.getElementById(c.clearBtn);this.tempoButton=document.getElementById(c.tempoSld);this.backButton.addEventListener("click",function(f){f.preventDefault();this.blur();b.app.closeAppView()},false);this.showMapButton.addEventListener("click",function(f){f.preventDefault();this.blur();b.showKeyboard()},false);this.printButton.addEventListener("click",function(f){f.preventDefault();this.blur();b.printPreview(b.renderedTune.div.innerHTML,["#topBar","#appDiv","#studioDiv"],b.renderedTune.abc.formatting.landscape)},false);this.lyricsButton.addEventListener("click",function(f){f.preventDefault();this.blur();if(b.midiPlayer.playing){b.stopPlay()}SITE.properties.options.lyrics=!SITE.properties.options.lyrics;b.parserparams.hideLyrics=!SITE.properties.options.lyrics;b.setLyricsIcon();b.fireChanged(0,{force:true,showProgress:true})},false);this.fingeringButton.addEventListener("click",function(f){f.preventDefault();this.blur();if(b.midiPlayer.playing){b.midiPlayer.stopPlay()}SITE.properties.options.fingering=!SITE.properties.options.fingering;b.parserparams.hideFingering=!SITE.properties.options.fingering;b.setFingeringIcon();b.fireChanged(0,{force:true,showProgress:true})},false);this.tabformatButton.addEventListener("click",function(f){f.preventDefault();
this.blur();if(b.midiPlayer.playing){b.midiPlayer.stopPlay()}SITE.properties.options.tabFormat=((SITE.properties.options.tabFormat+1)%6);b.accordion.setTabFormat(SITE.properties.options.tabFormat);b.shouldReprint=true;b.showKeyboard(SITE.properties.studio.keyboard.visible);b.fireChanged(0,{force:true,showProgress:false})},false);this.modeButton.addEventListener("click",function(f){f.preventDefault();this.blur();b.changePlayMode()},false);this.timerButton.addEventListener("click",function(f){f.preventDefault();this.blur();SITE.properties.studio.timerOn=!SITE.properties.studio.timerOn;b.setTimerIcon(0)},false);this.FClefButton.addEventListener("click",function(f){f.preventDefault();this.blur();SITE.properties.studio.bassOn=!SITE.properties.studio.bassOn;b.setBassIcon()},false);this.GClefButton.addEventListener("click",function(f){f.preventDefault();this.blur();SITE.properties.studio.trebleOn=!SITE.properties.studio.trebleOn;b.setTrebleIcon()},false);this.playButton.addEventListener("click",function(f){f.preventDefault();this.blur();window.setTimeout(function(){b.startPlay("normal")},0)},false);this.stopButton.addEventListener("click",function(f){f.preventDefault();this.blur();if(b.currentPlayTimeLabel){b.currentPlayTimeLabel.innerHTML="00:00"}b.stopPlay()},false);this.clearButton.addEventListener("click",function(f){f.preventDefault();this.blur();b.renderedTune.printer.clearSelection();b.accordion.clearKeyboard(true);b.currentPlayTimeLabel.innerHTML="00:00";b.stopPlay()},false);this.stepButton.addEventListener("click",function(f){f.preventDefault();this.blur();b.startPlay("note")},false);this.stepMeasureButton.addEventListener("click",function(f){f.preventDefault();b.startPlay("measure")},false);this.repeatButton.addEventListener("click",function(f){f.preventDefault();this.blur();if(!b.midiPlayer.playing){b.startPlay("repeat",b.gotoMeasureButton.value,b.untilMeasureButton.value)}},false);this.slider=new DRAGGABLE.ui.Slider(this.tempoButton,{min:25,max:200,start:100,step:25,speed:100,color:"white",bgcolor:"red",size:{w:140,h:35,tw:60},callback:function(f){b.midiPlayer.setAndamento(f)}});this.gotoMeasureButton.addEventListener("keypress",function(f){if(f.keyCode===13){b.startPlay("goto",this.value,b.untilMeasureButton.value)}},false);this.gotoMeasureButton.addEventListener("focus",function(f){if(this.value===SITE.translator.getResource("gotoMeasure").val){this.value=""}},false);this.gotoMeasureButton.addEventListener("blur",function(f){if(this.value===""){this.value=SITE.translator.getResource("gotoMeasure").val}},false);this.untilMeasureButton.addEventListener("keypress",function(f){if(f.keyCode===13){b.startPlay("goto",b.gotoMeasureButton.value,this.value)}},false);this.untilMeasureButton.addEventListener("focus",function(f){if(this.value===SITE.translator.getResource("untilMeasure").val){this.value=""}},false);this.untilMeasureButton.addEventListener("blur",function(f){if(this.value===""){this.value=SITE.translator.getResource("untilMeasure").val}},false);this.playerCallBackOnScroll=function(f){b.setScrolling(f)};this.playerCallBackOnPlay=function(f){var g=f.getTime().cTime;if(b.gotoMeasureButton&&!parseInt(b.untilMeasureButton.value)){b.gotoMeasureButton.value=f.currentMeasure}if(b.currentPlayTimeLabel){b.currentPlayTimeLabel.innerHTML=g}b.midiPlayer.setPlayableClefs((SITE.properties.studio.trebleOn?"T":"")+(SITE.properties.studio.bassOn?"B":""))};this.playerCallBackOnEnd=function(f){var g=b.midiPlayer.getWarnings();b.playButton.title=SITE.translator.getResource("playBtn");b.playButton.innerHTML='&#160;<i class="ico-play"></i>&#160;';b.renderedTune.printer.clearSelection();b.accordion.clearKeyboard(true)};this.midiParser=new ABCXJS.midi.Parse();this.midiPlayer=new ABCXJS.midi.Player(this);this.midiPlayer.defineCallbackOnPlay(this.playerCallBackOnPlay);this.midiPlayer.defineCallbackOnEnd(this.playerCallBackOnEnd);this.midiPlayer.defineCallbackOnScroll(this.playerCallBackOnScroll)};SITE.AppView.prototype.setup=function(b,a){this.setVisible(true);this.printedKeyboard=false;this.accordion.loadById(a);this.renderedTune.abc=b.abc;this.renderedTune.text=b.text;this.renderedTune.title=b.title;this.changePlayMode(SITE.properties.studio.mode);this.setBassIcon();this.setTrebleIcon();this.setTimerIcon(0);this.Div.setTitle(this.accordion.getFullName()+' <span data-translate="keys">'+SITE.translator.getResource("keys")+"</span>");this.Div.setSubTitle("- "+b.title);SITE.translator.translate(this.Div.topDiv);this.Div.setMenuVisible(true);this.showKeyboard(SITE.properties.studio.keyboard.visible);this.fireChanged(0,{force:true,showProgress:false});this.canvasDiv.scrollTop=0};SITE.AppView.prototype.showKeyboard=function(a){SITE.properties.studio.keyboard.visible=(typeof a==="undefined"?!SITE.properties.studio.keyboard.visible:a);this.accordion.render_opts.show=SITE.properties.studio.keyboard.visible;if(SITE.properties.studio.keyboard.visible){this.outerKeyboardDiv.style.display="inline-block";if(!this.printedKeyboard){this.printedKeyboard=true;this.shouldReprint=false;this.accordion.printKeyboard(this.keyboardDiv);this.setExtras()}if(this.shouldReprint){this.shouldReprint=false;this.accordion.loadedKeyboard.reprint();that.setExtras()}this.setRight();this.showMapButton.innerHTML='<i class="ico-keyboard" ></i>'}else{this.outerKeyboardDiv.style.display="none";this.showMapButton.innerHTML='<i class="ico-keyboard" style="opacity:0.5; filter: grayscale(1);"></i><i class="ico-forbidden" style="position:absolute;left:4px;top:4px; filter: grayscale(1);"></i>'}this.resize()};SITE.AppView.prototype.setRight=function(){if(SITE.properties.options.keyboardRight){if(this.kbDivs.openBtnRight.classList&&!this.kbDivs.openBtnRight.classList.contains("flip-vert")){this.kbDivs.openBtnRight.classList.add("flip-vert")}this.outerKeyboardDiv.classList.remove("keyboardDivLeft");this.outerCanvasDiv.classList.add("keyboardDivLeft")}else{if(this.kbDivs.openBtnRight.classList&&this.kbDivs.openBtnRight.classList.contains("flip-vert")){this.kbDivs.openBtnRight.classList.remove("flip-vert")}this.outerKeyboardDiv.classList.add("keyboardDivLeft");this.outerCanvasDiv.classList.remove("keyboardDivLeft")}};SITE.AppView.prototype.setExtras=function(){this.kbDivs=this.accordion.loadedKeyboard.divs;that=this;this.accordion.loadedKeyboard.showImagem(true);this.accordion.loadedKeyboard.showExtras(true);this.accordion.loadedKeyboard.showExtrasOpen(true);this.kbDivs.rotateBtnExtra.addEventListener("click",function(a){a.preventDefault();that.keyboardCallback("ROTATE")},false);this.kbDivs.globeBtnExtra.addEventListener("click",function(a){a.preventDefault();that.keyboardCallback("GLOBE")},false);this.kbDivs.openBtnRight.addEventListener("click",function(a){a.preventDefault();SITE.properties.options.keyboardRight=!SITE.properties.options.keyboardRight;that.showKeyboard(SITE.properties.studio.keyboard.visible)},false);SITE.translator.translate(this.kbDivs.extras)};SITE.AppView.prototype.keyboardCallback=function(a){switch(a){case"ROTATE":this.accordion.rotateKeyboard(this.keyboardDiv);
this.accordion.rotateKeyboard(this.keyboardDiv);this.setExtras();this.setRight();SITE.properties.studio.keyboard.transpose=this.accordion.render_opts.transpose;SITE.properties.studio.keyboard.mirror=this.accordion.render_opts.mirror;break;case"GLOBE":this.accordion.changeNotation();SITE.properties.studio.keyboard.label=this.accordion.render_opts.label;break;case"CLOSE":this.showKeyboard(false);break}};SITE.AppView.prototype.appViewCallBack=function(a){switch(a){case"CLOSE":this.app.closeAppView();break}};SITE.AppView.prototype.stopPlay=function(a){this.midiPlayer.stopPlay()};SITE.AppView.prototype.setVisible=function(a){this.Div.parent.style.display=a?"block":"none"};SITE.AppView.prototype.setScrolling=function(c){if(!this.canvasDiv||!c.currAbsElem||c.currAbsElem.staffGroup===this.lastStaffGroup){return}this.lastStaffGroup=c.currAbsElem.staffGroup;var e=c.printer.staffgroups[0].top;var b=this.canvasDiv.clientHeight-e;var d=c.printer.staffgroups[c.currAbsElem.staffGroup].top-12;var a=d+c.printer.staffgroups[c.currAbsElem.staffGroup].height;if(a>b+this.ypos||this.ypos>d-e){this.ypos=d;this.canvasDiv.scrollTop=this.ypos}};SITE.AppView.prototype.changePlayMode=function(a){SITE.properties.studio.mode=a?a:(SITE.properties.studio.mode==="normal"?"learning":"normal");this.midiPlayer.setAndamento(this.slider.getValue());if(SITE.properties.studio.mode==="normal"){$("#divDidacticPlayControls").hide();SITE.properties.studio.mode="normal";this.modeButton.innerHTML='<i class="ico-listening" ></i>';$("#divNormalPlayControls").fadeIn()}else{$("#divNormalPlayControls").hide();SITE.properties.studio.mode="learning";this.modeButton.innerHTML='<i class="ico-learning" ></i>';$("#divDidacticPlayControls").fadeIn()}};SITE.AppView.prototype.startPlay=function(b,d,a){this.ypos=this.canvasDiv.scrollTop;this.lastStaffGroup=-1;var c=this;if(this.midiPlayer.playing){if(b==="normal"){this.playButton.title=SITE.translator.getResource("playBtn");this.playButton.innerHTML='&#160;<i class="ico-play"></i>&#160;';this.midiPlayer.pausePlay()}else{this.midiPlayer.pausePlay(true)}}else{this.accordion.clearKeyboard();window.setTimeout(function(){c.StartPlayWithTimer(c.renderedTune.abc.midi,b,d,a,SITE.properties.studio.timerOn?10:0)},0)}};SITE.AppView.prototype.setBassIcon=function(){if(SITE.properties.studio.bassOn){this.FClefButton.innerHTML='<i class="ico-clef-bass" ></i>'}else{this.FClefButton.innerHTML='<i class="ico-clef-bass" style="opacity:0.5; filter: grayscale(1);"></i><i class="ico-forbidden" style="position:absolute;left:4px;top:3px; filter: grayscale(1);"></i>'}};SITE.AppView.prototype.setTrebleIcon=function(){if(SITE.properties.studio.trebleOn){this.GClefButton.innerHTML='<i class="ico-clef-treble" ></i>'}else{this.GClefButton.innerHTML='<i class="ico-clef-treble" style="opacity:0.5; filter: grayscale(1);"></i><i class="ico-forbidden" style="position:absolute;left:4px;top:3px; filter: grayscale(1);"></i>'}};SITE.AppView.prototype.setLyricsIcon=function(){if(SITE.properties.options.lyrics){this.lyricsButton.innerHTML='<i class="ico-letter-l" ></i>'}else{this.lyricsButton.innerHTML='<i class="ico-letter-l" style="opacity:0.5; filter: grayscale(1);"></i><i class="ico-forbidden" style="position:absolute;left:4px;top:4px; filter: grayscale(1);"></i>'}};SITE.AppView.prototype.setFingeringIcon=function(){if(SITE.properties.options.fingering){this.fingeringButton.innerHTML='<i class="ico-alien-fingering" ></i>'}else{this.fingeringButton.innerHTML='<i class="ico-alien-fingering" style="opacity:0.5; filter: grayscale(1);"></i><i class="ico-forbidden" style="position:absolute;left:4px;top:4px; filter: grayscale(1);"></i>'}};SITE.AppView.prototype.setTimerIcon=function(b){b=b||0;var a="00";if(SITE.properties.studio.timerOn){switch(b){case 0:a="00";break;case 1:a="05";break;case 2:a="15";break;case 3:a="20";break;case 6:a="30";break;case 9:a="45";break;default:a=""}if(a!==""){if(a!=="00"){MIDI.noteOn(0,90,100,0);MIDI.noteOff(0,90,b>3?0.1:0.05)}this.timerButton.innerHTML='<i class="ico-timer-'+a+'" ></i>'}}else{this.timerButton.innerHTML='<i class="ico-timer-00" style="opacity:0.5; filter: grayscale(1);"></i><i class="ico-forbidden" style="position:absolute;left:4px;top:6px; filter: grayscale(1);"></i>'}};SITE.AppView.prototype.StartPlayWithTimer=function(f,c,e,b,a){var d=this;if(c!=="note"&&SITE.properties.studio.timerOn&&a>0){d.setTimerIcon(a);a-=1;window.setTimeout(function(){d.StartPlayWithTimer(f,c,e,b,a)},1000/3)}else{d.setTimerIcon(0);if(c==="normal"){this.midiPlayer.setPlayableClefs("TB");if(this.midiPlayer.startPlay(this.renderedTune.abc.midi)){SITE.ga("event","play",{event_category:"Mapa",event_label:this.renderedTune.title});this.playButton.title=SITE.translator.getResource("pause");this.playButton.innerHTML='&#160;<i class="ico-pause"></i>&#160;'}}else{this.midiPlayer.setPlayableClefs((SITE.properties.studio.trebleOn?"T":"")+(SITE.properties.studio.bassOn?"B":""));SITE.ga("event","didactic-play",{event_category:"Mapa",event_label:this.renderedTune.title});this.midiPlayer.startDidacticPlay(this.renderedTune.abc.midi,c,e,b)}}};SITE.AppView.prototype.parseABC=function(c,d){var g=this.renderedTune.text;this.warnings=[];if(g===""){this.renderedTune.text=this.initialText=this.renderedTune.abc=undefined;return true}if(g===this.initialText&&!d){this.updateSelection();return false}if(typeof c!=="undefined"){if(this.transposer){this.transposer.reset(c)}else{this.transposer=new ABCXJS.parse.Transposer(c)}}if(!this.abcParser){this.abcParser=new ABCXJS.parse.Parse(this.transposer,this.accordion)}try{this.abcParser.parse(g,this.parserparams);this.renderedTune.abc=this.abcParser.getTune();this.renderedTune.text=this.initialText=this.abcParser.getStrTune()}catch(f){waterbug.log("Could not parse ABC.");waterbug.show()}var b=this.abcParser.getWarnings()||[];for(var a=0;a<b.length;a++){this.warnings.push(b[a])}if(this.midiParser){this.midiParser.parse(this.renderedTune.abc,this.accordion.loadedKeyboard);this.midiPlayer.reset();this.midiPlayer.setAndamento(this.slider.getValue());var b=this.midiParser.getWarnings();for(var a=0;a<b.length;a++){this.warnings.push(b[a])}}return true};SITE.AppView.prototype.onChange=function(){this.canvasDiv.scrollTop=this.lastYpos};SITE.AppView.prototype.fireChanged=function(b,a){if(this.changing){return}this.lastYpos=this.canvasDiv.scrollTop||0;this.changing=true;var c=a||{};var d=c.force||false;var e=c.showProgress||false;if(this.parseABC(b,d)){this.modelChanged(e)}else{delete this.changing}};SITE.AppView.prototype.modelChanged=function(c){var b=this;if(c){var a=SITE.startLoader("ModelChanged");a.start(function(){b.onModelChanged(a)},"<br>&nbsp;&nbsp;&nbsp;Gerando partitura...<br><br>")}else{b.onModelChanged()}};SITE.AppView.prototype.onModelChanged=function(a){this.renderedTune.div.innerHTML="";this.renderedTune.div.style.display="none";if(this.renderedTune.abc===undefined){delete this.changing;return}this.renderedTune.div.style.display="";var b=new SVG.Printer(this.renderedTune.div);
this.renderedTune.printer=new ABCXJS.write.Printer(b,this.printerparams,this.accordion.loadedKeyboard);this.renderedTune.printer.printTune(this.renderedTune.abc);this.renderedTune.printer.addSelectListener(this);this.updateSelection();if(this.onchangeCallback){this.onchangeCallback(this)}if(a){a.update(false,"<br>&nbsp;&nbsp;&nbsp;Gerando tablatura...<br><br>");a.stop()}this.media.show(this.renderedTune);delete this.changing};SITE.AppView.prototype.highlight=function(a){if(!this.midiPlayer.playing){if(SITE.properties.studio.keyboard.visible){this.accordion.clearKeyboard(true);this.midiParser.setSelection(a)}}};SITE.AppView.prototype.unhighlight=function(a){};SITE.AppView.prototype.updateSelection=function(b){var a=this;if(b){delete this.updating}else{if(this.updating){return}this.updating=true;setTimeout(a.updateSelection(true),300)}};SITE.AppView.prototype.printPreview=function(a,b,d){var c=this;c.dvPrintPane=document.getElementById("printPreviewDiv");c.divsToHide=b;c.savedDisplays={};b.forEach(function(f){var e=document.getElementById(f.substring(1));c.savedDisplays[f.substring(1)]=e.style.display;e.style.display="none"});SITE.ga("event","print",{event_category:"Mapa",event_label:this.renderedTune.title});this.changePageOrientation(d?"landscape":"portrait");c.dvPrintPane.innerHTML=a;c.dvPrintPane.style.display="block";setTimeout(function(){if(window.DiatonicApp){window.DiatonicApp.printPage(c.renderedTune.title)}else{window.print();c.endPreview()}})};SITE.AppView.prototype.endPreview=function(a,b,d){var c=this;c.dvPrintPane.style.display="none";c.divsToHide.forEach(function(f){var e=document.getElementById(f.substring(1));e.style.display=c.savedDisplays[f.substring(1)]})};SITE.AppView.prototype.changePageOrientation=function(a){var b=document.createElement("style");document.head.appendChild(b);b.innerHTML="@page {margin: 1cm; size: "+a+"}"};SITE.AppView.prototype.resize=function(){var f=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var b=(f-2);var a=SITE.properties.studio.keyboard.visible?this.keyboardDiv.clientWidth:0;this.Div.resize();var h=this.controlDiv.clientHeight;var g=this.Div.dataDiv.clientHeight;var e=this.Div.dataDiv.clientWidth;this.studioCanvasDiv.style.height=Math.max(g,300)+"px";this.outerCanvasDiv.style.height=this.studioCanvasDiv.clientHeight-h-15+"px";this.canvasDiv.style.height=this.outerCanvasDiv.clientHeight-4+"px";this.outerKeyboardDiv.style.height=this.studioCanvasDiv.clientHeight-h-15+"px";this.studioCanvasDiv.style.width=Math.max(e,600)+"px";this.canvasDiv.style.width=Math.min(1025,Math.max(b-a-10,100))+"px";this.outerCanvasDiv.style.width=this.canvasDiv.clientWidth+"px";(this.ps)&&this.ps.update();(this.ps2)&&this.ps2.update();this.media.posiciona()};if(!window.SITE){window.SITE={gtagInitiated:false,root:"/mapa"}}SITE.App=function(e,a,d){var b=0;if(SITE.size.h>=500){b=1}else{if(SITE.size.h>=432){b=1}else{if(SITE.size.h>=412){b=1}else{if(SITE.size.h>=393){b=0.95}else{if(SITE.size.h>=360){b=0.9}else{b=0.6}}}}}document.body.style.overflow="hidden";var c=this;this.container=document.getElementById("appDiv");this.tab={title:"",text:"",ddmId:"menuSongs",type:"songs"};this.modal=new SITE.Modal({disableLinks:true,print:false,callback:{listener:this,method:"closeModal"}});this.Back=[];this.Back.push({listener:this,method:"closeApp"});ABCXJS.write.color.useTransparency=SITE.properties.colors.useTransparency;ABCXJS.write.color.highLight=SITE.properties.colors.highLight;DIATONIC.map.color.fill=SITE.properties.colors.fill;DIATONIC.map.color.background=SITE.properties.colors.background;DIATONIC.map.color.close=SITE.properties.colors.close;DIATONIC.map.color.open=SITE.properties.colors.open;this.settingsMenu=document.getElementById(e.settingsMenu);this.accordion=new window.ABCXJS.tablature.Accordion(e.accordion_options,SITE.properties.options.tabFormat);this.accordionSelector=new ABCXJS.edit.AccordionSelector(e.mapMenuGaitasDiv,e.mapMenuGaitasDiv,{listener:c,method:"menuCallback",label:"Accordion"});this.tab.title=FILEMANAGER.loadLocal("property."+this.accordion.getId()+".songs.title")||this.accordion.loaded.getFirstSong();this.openBtn=document.getElementById(e.openBtn);this.openBtn.addEventListener("click",function(f){c.openAppView()},false);this.songSelector=document.getElementById(e.mapMenuSongsDiv);this.gaitaImagePlaceHolder=document.getElementById(e.accordionImagePlaceHolder);this.gaitaImagePlaceHolder.style.scale=b;this.settingsMenu.addEventListener("click",function(f){f.preventDefault();this.blur();c.showSettings()},false);this.setVersionLang();this.defineInstrument(true);this.showAccordionName();this.showAccordionImage();this.accordionSelector.populate(false);this.songSelectorPopulate();SITE.translator.translate();this.setVisible(true);this.resize()};SITE.App.prototype.changeAccordion=function(a){this.accordion.loadById(a.accordionId);this.showAccordionName();this.showAccordionImage();this.accordionSelector.populate(false);this.songSelectorPopulate();this.resize();if(!this.accordion.loaded.localResource){FILEMANAGER.saveLocal("property.accordion",this.accordion.getId())}};SITE.App.prototype.resize=function(){return};SITE.App.prototype.songSelectorPopulate=function(){var e=false;var f=this.accordion.loaded.songs;var a=this.tab.ddmId;var g="songs";this.menuSongs=new DRAGGABLE.ui.DropdownMenu(this.songSelector,{listener:this,method:"showABC",translate:false,label:"Song"},[{title:"...",ddmId:this.tab.ddmId,itens:[]}]);for(var d=0;d<f.sortedIndex.length;d++){var h=f.sortedIndex[d];var b=h.replace(/\(.*\)/g,"").trim();var j=0;if(!f.details[h]||isNaN(parseInt(f.details[h].id))){waterbug.logError('Missing or incorrect ID (X:nnn) for "'+h+'"');waterbug.show()}else{j=f.details[h].id}if(f.details[h].hidden){continue}var c=this.menuSongs.addItemSubMenu(a,b+"|"+g+"#"+j);if(h===this.tab.title){e=true;this.menuSongs.setSubMenuTitle(this.tab.ddmId,b);this.menuSongs.selectItem(this.tab.ddmId,c);this.tab.text=this.accordion.loaded.getAbcText(this.tab.type,h)}}if(!e&&f.sortedIndex.length>0){var h=f.sortedIndex[0];this.tab.title=h;var b=h.replace(/\(.*\)/g,"").trim();this.menuSongs.setSubMenuTitle(this.tab.ddmId,b);this.menuSongs.selectItem(this.tab.ddmId,this.tab.type+"#"+f.details[h].id);this.tab.text=this.accordion.loaded.getAbcText(this.tab.type,h)}};SITE.App.prototype.showABC=function(d){var c,e;var b=d.split("#");if(d.indexOf("#")>=0&&parseInt(b[1])>0){c=b[0];e=this.accordion.loaded[c].ids[b[1]]}else{waterbug.logError("ABCX not found!");waterbug.show();return}if(this.tab.title!==e&&this.menuSongs.selectItem(this.tab.ddmId,d)){this.tab.title=e;this.tab.text=this.accordion.loaded.getAbcText(c,e);var f=e.replace(/\(.*\)/g,"").trim();this.menuSongs.setSubMenuTitle(this.tab.ddmId,(f.length>43?f.substr(0,40)+"...":f));if(!this.accordion.loaded.localResource){FILEMANAGER.saveLocal("property."+this.accordion.getId()+"."+c+".title",e)}}else{console.log("Song title not found!")}};SITE.App.prototype.menuCallback=function(a){switch(a){case"GAITA_MINUANO_GC":case"CONCERTINA_PORTUGUESA":case"GAITA_HOHNER_MORINO":case"GAITA_HOHNER_CORONA_GCF":case"GAITA_HOHNER_CORONA_BEA":case"GAITA_HOHNER_CORONA_ADG":case"GAITA_HOHNER_CLUB_IIIM_BR":case"GAITA_MINUANO_BC_TRANSPORTADA":default:this.changeAccordion({accordionId:a})
}};SITE.App.prototype.openAppView=function(b,d){var c=this;if(d){d.preventDefault();b.blur()}if(!this.appView){this.appView=new SITE.AppView(this,{studioDiv:"studioDiv",keyboardDiv:"keyboardDiv",studioControlDiv:"studioControlDiv",studioCanvasDiv:"studioCanvasDiv",generate_tablature:"accordion",backBtn:"backBtn",showMapBtn:"showMapBtn",printBtn:"printBtn",btShowMedia:"buttonShowMedia",accordion_options:{id:this.accordion.getId(),accordionMaps:DIATONIC.map.accordionMaps,translator:SITE.translator,render_keyboard_opts:{}},onchange:function(e){e.onChange()}},{modeBtn:"modeBtn",lyricsBtn:"lyricsBtn",fingeringBtn:"fingeringBtn",tabformatBtn:"tabformatBtn",timerBtn:"timerBtn",playBtn:"playBtn",stopBtn:"stopBtn",clearBtn:"clearBtn",gotoMeasureBtn:"gotoMeasureBtn",untilMeasureBtn:"untilMeasureBtn",stepBtn:"stepBtn",repeatBtn:"repeatBtn",stepMeasureBtn:"stepMeasureBtn",tempoSld:"tempoSld",GClefBtn:"GClefBtn",FClefBtn:"FClefBtn",currentPlayTimeLabel:"currentPlayTimeLabel"})}this.Back.push({listener:this,method:"closeAppView"});if(c.tab.text){SITE.ga("event","page_view",{page_title:c.tab.title,page_path:SITE.root+"/"+c.accordion.getId(),event_category:"View"});var a=SITE.startLoader("openAppView");a.start(function(){c.appView.setup(c.tab,c.accordion.getId());a.stop()},"<br/>&#160;&#160;&#160;"+SITE.translator.getResource("wait")+"<br/><br/>")}};SITE.App.prototype.setVisible=function(a){this.container.style.display=(a?"block":"none")};SITE.App.prototype.showAccordionImage=function(){this.gaitaImagePlaceHolder.innerHTML=' <div class="shadow"></div><img src="'+this.accordion.loaded.image+'" alt="'+this.accordion.getFullName()+" "+SITE.translator.getResource("keys")+'" />'};SITE.App.prototype.showAccordionName=function(){var a=this.accordion.getFullName()+' <span data-translate="keys">'+SITE.translator.getResource("keys")+"</span>";this.accordionSelector.menu.setSubMenuTitle(this.accordionSelector.ddmId,a)};SITE.App.prototype.defineInstrument=function(b){var c=this;c.instrument=SITE.properties.options.pianoSound?"acoustic_grand_piano":"accordion";var a=function(){var d=SITE.properties.options.pianoSound?0:21;MIDI.programChange(0,d);MIDI.programChange(1,d);MIDI.programChange(2,d);MIDI.programChange(3,d);MIDI.programChange(4,d);MIDI.programChange(5,d)};if(b){a();return}MIDI.widget=new sketch.ui.Timer({size:180,cor1:SITE.properties.colors.close,cor2:SITE.properties.colors.open});MIDI.widget.setFormat(SITE.translator.getResource("loading"));MIDI.loadPlugin({soundfontUrl:"./soundfont/",instruments:c.instrument,onprogress:function(g,d,e){var f=((d*100)+e)/(g);MIDI.widget.setValue(Math.round(f))},callback:function(){a()}})};SITE.App.prototype.showSettings=function(){var e=this;var d=620;var b=70;this.Back.push({listener:this,method:"closeSettings"});if(!this.settings){this.settings={};this.settings.popupWin=new DRAGGABLE.ui.Window(null,null,{title:"PreferencesTitle",translator:SITE.translator,statusbar:false,top:"40px",left:b+"px",height:"450px",width:d+"px",zIndex:70},{listener:this,method:"settingsCallback"});SITE.ga("event","page_view",{page_title:SITE.translator.getResource("PreferencesTitle"),page_path:SITE.root+"/settings",event_category:"View"});this.settings.popupWin.topDiv.style.zIndex=101;this.settings.popupWin.dataDiv.innerHTML='        <div class="menu-group">            <table>              <tr>                <th colspan="2"><span data-translate="PrefsIdiom" >'+SITE.translator.getResource("PrefsIdiom")+'</span></th>                <th><div id="settingsLanguageMenu" class="topMenu"></div></th>              </tr>              <tr style="display:none;">                <th colspan="2"><br><span data-translate="PrefsTabFormat" >'+SITE.translator.getResource("PrefsTabFormat")+'</span></th>                <th><br><div id="settingsTabMenu" class="topMenu"></div></th>              </tr>              <tr style="height:20px; display:none;" >                <td> </td><td colspan="2"><div id="sldOnlyNumbers"></div>                <span data-translate="PrefsPropsOnlyNumbers" >'+SITE.translator.getResource("PrefsPropsOnlyNumbers")+'</span></a></td>              </tr>              <tr>                <th colspan="2"><br><span data-translate="PrefsColor" >'+SITE.translator.getResource("PrefsColor")+'</span></th><td></td>              </tr>              <tr>                <td style="width:15px;"></td><td data-translate="PrefsColorHighlight" >'+SITE.translator.getResource("PrefsColorHighlight")+'</td>                <td><input id="corRealce" type="text" readonly >&nbsp;<div id="sldTransparency"></div>                        <span data-translate="PrefsColorTransparency" >'+SITE.translator.getResource("PrefsColorTransparency")+'</span></td>              </tr>              <tr>                <td></td><td data-translate="PrefsColorClosingBellows" >'+SITE.translator.getResource("PrefsColorClosingBellows")+'</td>                <td><input readonly id="foleFechando" type="text" ></td>              </tr>              <tr>                <td></td><td data-translate="PrefsColorOpeningBellows" >'+SITE.translator.getResource("PrefsColorOpeningBellows")+'</td>                <td><input readonly id="foleAbrindo" type="text" ></td>              </tr>              <tr>                <th colspan="2"><br><span data-translate="PrefsProps" >'+SITE.translator.getResource("PrefsProps")+'</span></th><td></td>              </tr>              <tr style="height:40px;">                <td> </td><td colspan="2"><div id="sldPianoSound"></div>                <span data-translate="PrefsPropsCKPiano" >'+SITE.translator.getResource("PrefsPropsCKPiano")+'</span></a></td>              </tr>              <!--tr style="height:40px;">                <td> </td><td colspan="2"><div id="sldSuppressTitles"></div>                <span data-translate="PrefsPropsChkSuppressTitles" >'+SITE.translator.getResource("PrefsPropsChkSuppressTitles")+'</span></td>              </tr-->              <tr style="display:none;">                <td> </td><td colspan="2"><input id="chkWarnings" type="checkbox">&nbsp;                <span data-translate="PrefsPropsCKShowWarnings" >'+SITE.translator.getResource("PrefsPropsCKShowWarnings")+'</span></td>              </tr>              <tr style="display:none;">                <td> </td><td colspan="2"><input id="chkAutoRefresh" type="checkbox">&nbsp;                <span data-translate="PrefsPropsCKAutoRefresh" >'+SITE.translator.getResource("PrefsPropsCKAutoRefresh")+'</span></td>              </tr>              <tr style="height:30px; white-space:nowrap; font-family: Merienda;">                <td> </td><td colspan="2">                <a id="aPolicy"    href="" style="width:25%; display:block; float: left;"><span data-translate="PrivacyTitle">Politica</span></a>                </td>              </tr>              <tr style="height:30px; white-space:nowrap; font-family: Merienda;">                <td> </td><td colspan="2">                <a id="aTerms" href="" style="width:fit-content; display:block; float: left;"><span data-translate="TermsTitle">Termos</span></a>                </td>              </tr>              <tr style="height:30px; white-space:nowrap; font-family: Merienda;">                <td> </td><td colspan="2">                <a href="https://diatonicmap.com.br" target="_blank" style="width:25%; display:block; float: left;" >diatonicmap.com.br</a>                </td>              </tr>              </table>        </div>        <div id="pg" class="pushbutton-group" style="right: 0; bottom: 0;" >            <div id="botao0" style="left:-50px;"></div>\n            <div id="botao1"></div>\n            <div id="botao2"></div>\n            <div id="botao3"></div>\n        </div>';
this.settings.sldOnlyNumbers=new DRAGGABLE.ui.Slider(document.getElementById("sldOnlyNumbers"),{min:0,max:1,start:0,step:1,type:"bin",speed:100,color:"white",bgcolor:"red",size:{w:60,h:25,tw:40},callback:null});this.settings.sldTransparency=new DRAGGABLE.ui.Slider(document.getElementById("sldTransparency"),{min:0,max:1,start:0,step:1,type:"bin",speed:100,color:"white",bgcolor:"red",size:{w:60,h:25,tw:40},callback:null});this.settings.sldPianoSound=new DRAGGABLE.ui.Slider(document.getElementById("sldPianoSound"),{min:0,max:1,start:0,step:1,type:"bin",speed:100,color:"white",bgcolor:"red",size:{w:60,h:25,tw:40},callback:null});this.settings.popupWin.addPushButtons(["botao0|tour|Take a tour","botao1|apply","botao2|reset|PrefsReset","botao3|cancel"]);this.settings.menu=new DRAGGABLE.ui.DropdownMenu("settingsLanguageMenu",{listener:this,method:"settingsCallback",translate:false},[{title:"Idioma",ddmId:"menuIdiomas",itens:[]}]);this.settings.tabMenu=new DRAGGABLE.ui.DropdownMenu("settingsTabMenu",{listener:this,method:"settingsCallback",translate:false},[{title:"...",ddmId:"menuFormato",itens:["&#160;Modelo Alemão|0TAB","&#160;Numérica Cíclica|1TAB","&#160;Numérica Contínua|2TAB"]}]);this.aTerms=document.getElementById("aTerms");this.aPolicy=document.getElementById("aPolicy");this.aPolicy.addEventListener("click",function(f){f.preventDefault();this.blur();e.Back.push({listener:e,method:"closeModal"});if(SITE.properties.options.language.toUpperCase().indexOf("PT")>=0){e.modal.show("PrivacyTitle","","privacy/policy.pt-BR.html")}else{if(SITE.properties.options.language.toUpperCase().indexOf("ES")>=0){e.modal.show("PrivacyTitle","","privacy/policy.es-ES.html")}else{e.modal.show("PrivacyTitle","","privacy/policy.en-US.html")}}},false);this.aTerms.addEventListener("click",function(f){f.preventDefault();this.blur();e.Back.push({listener:e,method:"closeModal"});if(SITE.properties.options.language.toUpperCase().indexOf("PT")>=0){e.modal.show("TermsTitle","","privacy/terms.pt-BR.html")}else{if(SITE.properties.options.language.toUpperCase().indexOf("ES")>=0){e.modal.show("TermsTitle","","privacy/terms.es-ES.html")}else{e.modal.show("TermsTitle","","privacy/terms.en-US.html")}}},false);var a=(SITE.properties.options.tabFormat%2);var c=(SITE.properties.options.tabFormat-a)/2;this.settings.tabFormat=c;this.settings.tabMenu.setSubMenuTitle("menuFormato",this.settings.tabMenu.selectItem("menuFormato",this.settings.tabFormat.toString()+"TAB"));SITE.properties.options.tabShowOnlyNumbers=(a===1);this.picker=new DRAGGABLE.ui.ColorPicker(["corRealce","foleFechando","foleAbrindo"],{readonly:false,translator:SITE.translator});SITE.translator.menuPopulate(this.settings.menu,"menuIdiomas");this.settings.lang=SITE.properties.options.language;this.settings.corRealce=document.getElementById("corRealce");this.settings.closeColor=document.getElementById("foleFechando");this.settings.openColor=document.getElementById("foleAbrindo");this.settings.showWarnings=document.getElementById("chkWarnings");this.settings.autoRefresh=document.getElementById("chkAutoRefresh");SITE.translator.translate()}this.settings.originalOnlyNumber=SITE.properties.options.tabShowOnlyNumbers;this.settings.originalLang=SITE.properties.options.language;this.settings.originalPianoSound=SITE.properties.options.pianoSound;this.settings.corRealce.style.backgroundColor=this.settings.corRealce.value=SITE.properties.colors.highLight;this.settings.closeColor.style.backgroundColor=this.settings.closeColor.value=SITE.properties.colors.close;this.settings.openColor.style.backgroundColor=this.settings.openColor.value=SITE.properties.colors.open;this.settings.sldOnlyNumbers.setValue(SITE.properties.options.tabShowOnlyNumbers?"1":"0",false);this.settings.sldTransparency.setValue(SITE.properties.colors.useTransparency?"1":"0",false);this.settings.sldPianoSound.setValue(SITE.properties.options.pianoSound?"1":"0",false);this.settings.showWarnings.checked=SITE.properties.options.showWarnings;this.settings.autoRefresh.checked=SITE.properties.options.autoRefresh;this.settings.popupWin.setVisible(true)};SITE.App.prototype.settingsCallback=function(b,a){switch(b){case"0TAB":case"1TAB":case"2TAB":this.settings.tabFormat=b;this.settings.tabMenu.setSubMenuTitle("menuFormato",this.settings.tabMenu.selectItem("menuFormato",b));break;case"de_DE":case"en_US":case"es_ES":case"fr_FR":case"it_IT":case"pt_BR":case"ru_RU":this.settings.lang=b;this.settings.menu.setSubMenuTitle("menuIdiomas",this.settings.menu.selectItem("menuIdiomas",b));break;case"MOVE":break;case"CLOSE":case"CANCEL":this.Back.pop();this.picker.close();this.settings.popupWin.setVisible(false);break;case"APPLY":SITE.properties.colors.highLight=this.settings.corRealce.value;SITE.properties.colors.close=this.settings.closeColor.value;SITE.properties.colors.open=this.settings.openColor.value;SITE.properties.colors.useTransparency=this.settings.sldTransparency.getBoolValue();SITE.properties.options.tabShowOnlyNumbers=this.settings.sldOnlyNumbers.getBoolValue();SITE.properties.options.pianoSound=this.settings.sldPianoSound.getBoolValue();SITE.properties.options.language=this.settings.lang;SITE.properties.options.showWarnings=this.settings.showWarnings.checked;SITE.properties.options.autoRefresh=this.settings.autoRefresh.checked;this.Back.pop();this.picker.close();this.settings.popupWin.setVisible(false);this.applySettings();SITE.SaveProperties();break;case"RESET":this.alert=new DRAGGABLE.ui.Alert(this.settings.popupWin,b,"<br>"+SITE.translator.getResource("resetMsgTitle"),"<br>"+SITE.translator.getResource("resetMsgDescription"),{translator:SITE.translator});break;case"RESET-YES":this.alert.close();this.picker.close();this.settings.popupWin.setVisible(false);SITE.ResetProperties();SITE.ga("event","reset",{event_category:"Configuration",event_label:SITE.properties.version});this.applySettings();break;case"RESET-NO":case"RESET-CANCEL":this.alert.close();break;case"TOUR":this.Back.pop();this.picker.close();this.settings.popupWin.setVisible(false);initEnjoyVars();SITE.myTour=new EnjoyHint(g_enjoyhint_opts);SITE.myTour.set(g_enjoyhint_script_steps);SITE.myTour.resume();break}};SITE.App.prototype.applySettings=function(){if(parseInt(this.settings.tabFormat)!==SITE.properties.options.tabFormat||this.settings.originalOnlyNumber!==SITE.properties.options.tabShowOnlyNumbers){SITE.properties.options.tabFormat=parseInt(this.settings.tabFormat);this.accordion.setTabFormat(SITE.properties.options.tabFormat);if(this.appView){this.appView.accordion.setTabFormat(SITE.properties.options.tabFormat)}}if(this.settings.originalLang!==SITE.properties.options.language){SITE.ga("event","changeLang",{event_category:"Configuration",event_label:SITE.properties.options.language});SITE.translator.loadLanguage(this.settings.lang,function(){SITE.translator.translate()});this.setVersionLang()}if(this.settings.originalPianoSound!==SITE.properties.options.pianoSound){SITE.ga("event","changeInstrument",{event_category:"Configuration",event_label:SITE.properties.options.pianoSound?"piano":"accordion"});
this.defineInstrument()}this.resizeActiveWindow();ABCXJS.write.color.useTransparency=SITE.properties.colors.useTransparency;ABCXJS.write.color.highLight=SITE.properties.colors.highLight;DIATONIC.map.color.close=SITE.properties.colors.close;DIATONIC.map.color.open=SITE.properties.colors.open;this.accordion.loadedKeyboard.legenda.setOpen();this.accordion.loadedKeyboard.legenda.setClose()};SITE.App.prototype.resizeActiveWindow=function(){if(this.appView&&window.getComputedStyle(this.appView.Div.parent).display!=="none"){this.appView.resize()}else{this.resize()}};SITE.App.prototype.silencia=function(a){if(this.appView&&window.getComputedStyle(this.appView.Div.parent).display!=="none"){if(this.appView.midiPlayer.playing){if(a){this.appView.midiPlayer.stopPlay()}else{this.appView.startPlay("normal")}}}};SITE.App.prototype.setVersionLang=function(){var a=this;this.aVersion=document.getElementById("aVersion");this.aVersion.addEventListener("click",function(b){b.preventDefault();this.blur();a.Back.push({listener:a,method:"closeModal"});if(SITE.properties.options.language.toUpperCase().indexOf("PT")>=0){a.modal.show("AboutAppTitle","","privacy/aboutApp.pt-BR.html")}else{if(SITE.properties.options.language.toUpperCase().indexOf("ES")>=0){a.modal.show("AboutAppTitle","","privacy/aboutApp.es-ES.html")}else{a.modal.show("AboutAppTitle","","privacy/aboutApp.en-US.html")}}},false)};SITE.App.prototype.closeSettings=function(){this.settingsCallback("CLOSE")};SITE.App.prototype.closeModal=function(){this.modal.close();this.Back.pop()};SITE.App.prototype.closeAppView=function(){this.appView.setVisible(false);this.appView.stopPlay();SITE.SaveProperties();this.Back.pop()};SITE.App.prototype.closeApp=function(){window.DiatonicApp&&window.DiatonicApp.closeApp()};SITE.App.prototype.goBackOrClose=function(){var a=this.Back[this.Back.length-1];return a.listener[a.method]()};SITE.App.prototype.setFocus=function(){};var g_enjoyhint_opts;const en_US=0;const pt_BR=1;const es_ES=2;var g_enjoyhint_text=[[],[],[]];function initEnjoyVars(){g_enjoyhint_opts={btnNextText:SITE.translator.getResource("Next"),btnPrevText:SITE.translator.getResource("Previous"),btnSkipText:SITE.translator.getResource("Dismiss"),backgroundColor:"rgba(0,0,0,0.6)",arrowColor:"white",onEnd:function(){SITE.properties.options.guidedTour=true;SITE.SaveProperties();document.body.style.overflow="hidden"},onSkip:function(){SITE.properties.options.guidedTour=true;SITE.SaveProperties();SITE.myTour.destroy();document.body.style.overflow="hidden"}};switch(SITE.properties.options.language){case"pt_BR":ge_lang=pt_BR;break;case"es_ES":ge_lang=es_ES;break;default:ge_lang=en_US}g_enjoyhint_script_steps=[{"next #appTitle":g_enjoyhint_text[ge_lang][1],nextButton:{text:SITE.translator.getResource("Start")}},{"next #topSettings":g_enjoyhint_text[ge_lang][2],shape:"circle",radius:36},{"next #menuGaitas":g_enjoyhint_text[ge_lang][3]},{"next #menuSongs":g_enjoyhint_text[ge_lang][4]},{"click #openBtn":g_enjoyhint_text[ge_lang][5],showSkip:false,top:-7,bottom:-4,left:-7,onBeforeStart:function(){myApp.changeAccordion({accordionId:"GAITA_HOHNER_CORONA_GCF"});myApp.showABC("songs#6011")}},{"next #controlDiv":g_enjoyhint_text[ge_lang][6],closeButton:{className:"myClose"},nextButton:{text:SITE.translator.getResource("Start")},showPrev:false,disableSelector:true,bottom:7,left:5,right:10,onBeforeStart:function(){myApp.appView.media.callback("CLOSE");myApp.appView.changePlayMode("normal")}},{"next .ico-keyboard":g_enjoyhint_text[ge_lang][7],shape:"circle",radius:22},{"next #keyboardExtraBtnDiv":g_enjoyhint_text[ge_lang][8],onBeforeStart:function(){myApp.appView.showKeyboard(true)},disableSelector:true},{"next .ico-printer":g_enjoyhint_text[ge_lang][9],shape:"circle",radius:22,disableSelector:true},{"next .ico-tabformat":g_enjoyhint_text[ge_lang][10],shape:"circle",radius:22},{"next .ico-alien-fingering2":g_enjoyhint_text[ge_lang][11],shape:"circle",radius:22},{"next .ico-letter-l":g_enjoyhint_text[ge_lang][12],shape:"circle",radius:22},{"next .ico-clef-treble":g_enjoyhint_text[ge_lang][13],shape:"circle",radius:22},{"next .ico-clef-bass":g_enjoyhint_text[ge_lang][14],shape:"circle",radius:22},{"next .ico-timer-00":g_enjoyhint_text[ge_lang][15],shape:"circle",radius:22},{"next #tempoBtnId":g_enjoyhint_text[ge_lang][16],top:-2,bottom:-4,left:2,right:2},{"next #modeBtn":g_enjoyhint_text[ge_lang][17],shape:"circle",radius:24},{"next #stepBtn":g_enjoyhint_text[ge_lang][18],onBeforeStart:function(){myApp.appView.changePlayMode("learning")},shape:"circle",radius:22},{"next #stepMeasureBtn":g_enjoyhint_text[ge_lang][19],shape:"circle",radius:22},{"next .input-group":g_enjoyhint_text[ge_lang][20],top:0,bottom:10,disableSelector:true},{"next #repeatBtn":g_enjoyhint_text[ge_lang][21],shape:"circle",radius:22},{"next #clearBtn":g_enjoyhint_text[ge_lang][22],shape:"circle",radius:22},{"next #buttonShowMedia":g_enjoyhint_text[ge_lang][23],shape:"circle",radius:22},{"next #outerCanvasDiv":g_enjoyhint_text[ge_lang][24],scrollAnimationSpeed:2500,onBeforeStart:function(){myApp.appView.media.callback("CLOSE");myApp.appView.changePlayMode("normal")},disableSelector:true,shape:"circle",radius:280},{"click .ico-home":g_enjoyhint_text[ge_lang][25],scrollAnimationSpeed:2500,skipButton:{text:SITE.translator.getResource("Finish")},shape:"circle",radius:26}]}g_enjoyhint_text[pt_BR]=["dummy","Vamos conhecer as principais funcionalidades deste Aplicativo?<br><text class='hint_laranja'>Observação: Você sempre poderá reiniciar este tour clicando em <i class='ico-menu'></i> no canto superior esquerdo do aplicativo.</text>",'Use o menu "Ajustes" para mudar coisas, tais como, o idioma <br>ou usar sons de piano acústico e outras mais.',"Confira a caixa de listagem de acordeões<br>e escolha um de sua preferência.","Escolha, também, uma das músicas disponíveis na lista.<br><text class='hint_laranja'>Observação: Só desta vez, eu escolherei, por você, uma música para<br>melhor demonstrar as funcionalidades da próxima página.</text>",'Agora, clique no botão "Abrir" para começar a aprender!',"Pronto para conhecer as facilidades da barra de menu?","Este botão mostra/oculta o layout do teclado. <text class='hint_tryit'>Experimente agora!</text>","O teclado em si também possui alguns controles úteis:<br><div style='text-align:left; margin-left:3em'><text class='hint_azul'><i class='ico-rotate' ></i> - </text><text class='hint_verde'>Espelha os botões do teclado (flip vertical);</text><br><text class='hint_azul'><i class='ico-world' ></i> - </text><text class='hint_verde'>Altera a notação dos nomes das notas; e</text><br><text class='hint_azul'><i class='ico-open-right'></i> - </text><text class='hint_verde'>Alterna o lado do teclado: esquerda/direita.</text><div>","Mostra uma prévia da impressão da música atual.","Altera entre as diferentes representações da tablatura. Atualmente há 3 formatos distintos.&nbsp;<text class='hint_tryit'>Experimente agora!</text><br><text class='hint_laranja'>Observação: Maiores detalhes podem ser vistos na página \"https://diatonicmap.com.br/tablature\"</text>","Este botão mostra/oculta os dedilhados da tablatura (se presentes). <text class='hint_tryit'>Experimente agora!</text>","Este botão mostra/oculta a letra da música (se houver). <text class='hint_tryit'>Experimente agora!</text>","Este botão ativa/desativa o som da melodia durante a execução MIDI.","Este botão ativa/desativa o som do ritmo baixo durante a execução MIDI.","Este botão ativa/desativa um breve temporizador antes de começar a execução.",'Deslize este botão para controlar o "Andamento" (velocidade) da execução MIDI.',"Este botão alterna entre o modo de execução normal e o modo de aprendizagem:<br><text class='hint_azul'><i class='ico-listening'></i>&nbsp;Modo Normal:&nbsp;</text><text class='hint_verde'>Compreende um conjunto simples de botões<br>play/pause <i class='ico-play'></i>/<i class='ico-pause'></i> e stop <i class='ico-stop'></i> para permitir a execução da partitura;</text><br><text class='hint_azul'><i class='ico-learning'></i>&nbsp;Modo de aprendizagem:&nbsp;</text><text class='hint_verde'>Este modo adiciona um conjunto de opções<br>para usar enquanto você estiver estudando a partitura.<br><text class='hint_laranja'>Observação: A seguir, ajustarei o \"Modo de aprendizagem\" para a parte final da demonstração.</text>",'No "Modo de Aprendizagem", este botão executa uma nota por vez, em um estilo "passo-a-passo".',"Este botão reproduz um compasso por vez ou compasso atual até o seu fim.","Use estas caixas de texto para limitar um conjunto de compassos numerados.<br>Se você preencher apenas o primeiro campo, a compasso escolhido será repetido.<br>No entanto, ao preencher ambos com números apropriados, o intervalo de compassos será repetido.","Este botão aplicará e executará a repetição que você configurou nos campos anteriores.","Este botão interrompe qualquer reprodução em andamento e coloca o cursor MIDI na posição inicial.","Este botão abre uma janela vinculada às videoaulas do Youtube (se existirem).","<div class='enjoy_hint_backgr'>Este é o produto final deste aplicativo: uma partitura com tablatura.<br>Para saber mais sobre esta metodologia de tablaturas para acordeão, dê uma olhada em:<br><text class='hint_link'>https://diatonicmap.com.br/tablature</text><br>Você também pode conferir a versão para website do aplicativo:<br><text class='hint_link'>https://diatonicmap.com.br</text><br><text class='hint_black'>Aproveite toda a comodidade de uma tela maior, com o mesmo repertório e muitos recursos extras de edição!</text></div>","<div class='enjoy_hint_backgr'>Finalmente, clique em <i class='ico-home'> para voltar à página inicial e finalizar este tour.<br>Obrigado por ter acompanhado este tutorial até aqui e espero que você goste deste aplicativo.<br>Você pode entrar em contato comigo pelo e-mail <text class='hint_link'>flavio.vani@gmail.com</text><br><text class='hint_black'>Seus comentários/sugestões/elogios ou críticas são bem-vindos!</text><br></div>"];
g_enjoyhint_text[es_ES]=["dummy","¿Conozcamos las características principales de esta Aplicación?<br><text class='hint_laranja'>Nota: siempre puedes reiniciar este tour haciendo clic en <i class='ico-menu'></i><br>en la esquina superior izquierda de la aplicación.</text>",'Utilice el menú "Ajustes" para cambiar cosas como el idioma<br>o usar sonidos de piano acústico y más.',"Consulta el cuadro de lista de acordeones<br>y elige uno que te guste.","Elige también una de las canciones disponibles en la lista.<br><text class='hint_laranja'>Nota: Sólo por esta vez, elegiré para ti una canción para<br> mejor demonstrar las funciones en la página siguiente.</text>",'¡Ahora, haz clic en el botón "Abrir" para comenzar a aprender!',"Listo para conocer las características de la barra de menú?","Este botón muestra/oculta la distribución del teclado. <text class='hint_tryit'>¡Pruébalo ahora!</text>","El teclado en sí también tiene algunos controles útiles:<br><div style='text-align:left; margin-left:3em'><text class='hint_azul'><i class='ico-rotate'></i> - </text><text class='hint_verde'>Refleja los botones del teclado (volteo vertical);</text><br><text class='hint_azul'><i class='ico-world'></i>- </text><text class='hint_verde'>Cambia la notación de los nombres de las notas; y</text><br><text class='hint_azul'><i class='ico-open-right'></i> - </text><text class='hint_verde'>Cambia el lado del teclado: izquierda/derecha.</text><div>","Muestra una vista previa de impresión de la canción actual.","Cambia entre las diferentes representaciones de tablatura. Actualmente hay 3 formatos diferentes.<text class='hint_tryit'>¡Pruébalo ahora!</text><br><text class='hint_laranja'>Nota: Más detalles se pueden ver en la página \"https://diatonicmap.com.br/tablature\"</text>","Este botón muestra/oculta las digitaciones de la tablatura (si están presentes). <text class='hint_tryit'>¡Pruébalo ahora!</text>","Este botón muestra/oculta la letra de la canción (si está presente). <text class='hint_tryit'>¡Pruébalo ahora!</text>","Este botón activa o desactiva el sonido de la melodía durante la reproducción MIDI.","Este botón activa o desactiva el sonido del ritmo del bajo durante la reproducción MIDI.","Este botón activa/desactiva un breve temporizador antes de que comience la ejecución.",'Deslice ésta perilla para controlar el "Tempo" (velocidad) de la reproducción MIDI.',"Este botón alterna entre el modo de ejecución normal y el modo de aprendizaje:<br><text class='hint_azul'><i class='ico-listening'></i>&nbsp;Modo normal:&nbsp;</text><text class='hint_verde'>Consta de un conjunto simple de botones<br>reproducir/pausa <i class='ico-play'></i>/<i class='ico-pause'></i>  y detenga <i class='ico-stop'></i> para permitir que se reproduzca la partitura;</text><br><text class='hint_azul'><i class='ico-learning'></i>&nbsp;Modo de aprendizaje:&nbsp;</text><text class='hint_verde'>Este modo agrega un conjunto de opciones<br>para usar mientras estudias la partitura.<br><text class='hint_laranja'>Nota: A continuación, ajustaré el \"Modo de aprendizaje\" para la parte final de la demostración.</text>",'En "Modo de aprendizaje", este botón reproduce una nota a la vez, en un estilo "paso-a-paso".',"Este botón reproduce un compás a la vez o el compás actual hasta su final.","Utilice estos cuadros de texto para limitar un conjunto de compases numerados.<br>Si sólo rellenas el primer campo, se repetirá el compás elegido.<br>Sin embargo, al completar ambos con los números apropiados, se repetirá la gama de compases.","Este botón aplicará y ejecutará la repetición que configuró en los campos anteriores.","Este botón detiene cualquier reproducción en curso y coloca el cursor MIDI en la posición inicial.","Este botón abre una ventana vinculada a lecciones en vídeo de YouTube (si estan presentes).","<div class='enjoy_hint_backgr'>Este es el producto final de esta aplicación: una partitura con tablatura.<br>Para aprender más sobre esta metodología de tablaturas de acordeón, echa un vistazo a:<br><text class='hint_link'>https://diatonicmap.com.br/tablature</text><br>También puedes consultar la versión del sitio web de la aplicación:<br><text class='hint_link'>https://diatonicmap.com.br</text><br><text class='hint_black'>¡Disfruta de toda la comodidad de una pantalla más grande, con el mismo repertorio y muchas funciones de edición adicionales!</text></div>","<div class='enjoy_hint_backgr'>Finalmente, haga clic en <i class='ico-home'> para regresar a la página de inicio y finalizar este tour.<br>Gracias por seguir este tutorial hasta ahora y espero que disfrutes esta aplicación.<br>Puedes contactarme en <text class='hint_link'>flavio.vani@gmail.com</text><br><text class='enjoy_hint_note_footrodape'>¡Tus comentarios/sugerencias/elogios o críticas son bienvenidos!</text><br></div>"];g_enjoyhint_text[en_US]=["dummy","Let's learn about the main features of this App?<br><text class='hint_laranja'>Note: You can always restart this tour by clicking <i class='ico-menu'></i> on left-top corner of the App.</text>",'Use the "Settings" menu to change stuff such as the language <br>or to use piano sounds and more.',"Checkout the accordion listbox <br>and choose the one of your prefference.","Also, choose an available song from the list.<br><text class='hint_laranja'>Note: Only this time, I'll choose you a song<br>for a better demonstration.</text>",'Now, click the "Open" button to start learning!',"Are you ready to know the facilities on the menu bar?","This button shows/hides the keyboard layout. <text class='hint_tryit'>Try it now!</text>","The keyboard itself also has some useful controls:<br><div style='text-align:left; margin-left:3em'><text class='hint_azul'><i class='ico-rotate' ></i> - </text><text class='hint_verde'>Mirrors the keyboard's buttons (vertical flip);</text><br><text class='hint_azul'><i class='ico-world' ></i> - </text><text class='hint_verde'>Changes the note names notation; and</text><br><text class='hint_azul'><i class='ico-open-right'></i> - </text><text class='hint_verde'>Shifts the keyboard side: left/right.</text><div>","Shows a print preview for the current song.","Switches between the different tablature representations. Currently there are 3 different formats.&nbsp;<text class='hint_tryit'>Try it now!</text><br><text class='hint_laranja'>Note: More details can be seen on the page \"https://diatonicmap.com.br/tablature\"</text>","This button shows/hides the tablature fingering (if present). <text class='hint_tryit'>Try it now!</text>","This button shows/hides the song lyrics (if present). <text class='hint_tryit'>Try it now!</text>","This button mutes/unmutes the sound of the melody during the MIDI execution.","This button mutes/unmutes the sound of the bass rhythm during the MIDI execution.","This button enables/disables a short timer before start playing.",'This slide the button to controls the "Tempo" (velocity) of the MIDI execution.',"This button switches between the normal execution mode and the learning mode:<br><text class='hint_azul'><i class='ico-listening'></i>&nbsp;Normal Mode:&nbsp;</text><text class='hint_verde'>Comprises a simple Play/Pause <i class='ico-play'></i>/<i class='ico-pause'></i> and Stop <i class='ico-stop'></i><br>set of buttons to execute the partiture;</text><br><text class='hint_azul'><i class='ico-learning'></i>&nbsp;Learning Mode:&nbsp;</text><text class='hint_verde'>This mode adds a set of handful options<br>to use while you are studying the partiture.<br><text class='hint_laranja'>Note: Next, I will adjust the \"Learning Mode\" for the final part of the demonstration.</text>",'In the "Learning Mode", this plays one note at time, in a step-by-step fashion.',"This button plays one measure at a time or the current one until its end.","Use these text boxes to limit a set of numbered measures.<br>If you only fill in the first field, then the chosen measure will be repeated.<br>However, by filling both with appropriate numbers, the interval will be repeated.","This button will apply and execute the repetition you configured in the previous fields.","This stops any playback in progress and places the MIDI cursor at the starting point.","This opens a window linked to Youtube video lessons (if present).","<div class='enjoy_hint_backgr'>This is the final product of this app: a partiture with tablature.<br>To learn more about this tablature for accordions methodology, please, take a look at:<br><text class='hint_link'>https://diatonicmap.com.br/tablature</text><br>You can also checkout the website version:<br><text class='hint_link'>https://diatonicmap.com.br</text><br><text class='hint_black'>Enjoy all the convenience of a bigger screen, with the same repertoire and many extra editing features!</text></div>","<div class='enjoy_hint_backgr'>Finally, click <i class='ico-home'> to go back to the initial page and finish this tour.<br>Thank you for following this until here and I hope you enjoy this app.<br>You can reach me at <text class='hint_link'>flavio.vani@gmail.com</text><br><text class='hint_black'>Your comments/suggestions/compliments or criticisms are welcome!</text><br></div>"];